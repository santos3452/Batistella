<div class="product-card flex flex-col h-full bg-white rounded-lg shadow-sm overflow-hidden opacity-0 animate-slide-in cursor-pointer" 
  [style.animation-delay]="animationDelay"
  (click)="navigateToDetail()">
  <div class="relative h-64 bg-gray-100">
    <img
      [src]="product.imageUrl"
      [alt]="product.fullName"
      class="w-full h-full object-contain"
    />
    <div class="absolute top-2 left-2 text-xs px-1.5 py-0.5 bg-gray-100 text-gray-800 rounded-md">
      {{ getAnimalTypeLabel(product.animalType) }}
    </div>
  </div>
  <div class="p-4 flex-1 flex flex-col">
    <h3 class="font-medium mb-1">{{ product.fullName }}</h3>
    <p class="text-sm text-gray-500 mb-2 line-clamp-2 flex-1">{{ product.description }}</p>
    
    <!-- Selector de peso para productos con variantes -->
    <div *ngIf="hasVariants && productGroup" class="text-sm mb-2">
      <label for="weightSelect" class="text-xs text-gray-600 block mb-1">Peso disponible:</label>
      <div class="flex flex-wrap gap-1">
        <button 
          *ngFor="let variant of productGroup.variants; let i = index" 
          [class.bg-teal-100]="i === selectedVariantIndex"
          [class.border-teal-500]="i === selectedVariantIndex"
          [class.text-teal-700]="i === selectedVariantIndex"
          [class.opacity-50]="variant.stock === 0"
          [disabled]="variant.stock === 0"
          (click)="selectVariant(i); $event.stopPropagation()"
          class="px-2 py-1 text-xs border rounded-md transition-colors hover:bg-gray-100 focus:outline-none focus:ring-1 focus:ring-teal-500"
        >
          {{ variant.kg }}
          <span *ngIf="variant.stock === 0" class="ml-1 text-red-500">(Sin stock)</span>
        </button>
      </div>
    </div>
    
    <!-- Peso Ãºnico para productos sin variantes -->
    <div *ngIf="!hasVariants" class="text-xs text-gray-600 mb-2">{{ currentWeight }}</div>
    
    <div class="mt-auto flex items-center justify-between">
      <span class="text-lg font-semibold">{{ utils.formatCurrency(currentPrice) }}</span>
      <button 
        class="flex items-center bg-teal-600 text-white py-1 px-3 rounded-md hover:bg-teal-700 transition duration-150"
        (click)="addToCart($event)"
        [disabled]="hasVariants && selectedVariant && selectedVariant.stock === 0"
        [class.opacity-50]="hasVariants && selectedVariant && selectedVariant.stock === 0"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-1">
          <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <path d="M16 10a4 4 0 0 1-8 0"></path>
        </svg>
        Agregar
      </button>
    </div>
  </div>
</div>
